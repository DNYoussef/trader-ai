[pytest]
# ISS-008: Pytest configuration for Gary x Taleb trading system

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths = tests

# Markers for test categorization (ISS-008: Comprehensive markers)
markers =
    # Core test types
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (may require mocking external services)
    e2e: End-to-end tests (full system workflow)
    slow: Slow-running tests (>5 seconds)

    # Component markers
    broker: Broker-related tests (Alpaca adapter, connections)
    trading: Trading engine tests
    portfolio: Portfolio management tests
    gates: Gate system tests (capital progression)
    cycle: Weekly cycle tests (Friday timing)
    safety: Safety system tests (kill switch, circuit breakers)
    market_data: Market data tests

    # Feature markers
    plaid: Plaid-specific tests
    database: Database-related tests
    api: API endpoint tests
    websocket: WebSocket tests
    authentication: Authentication tests (hardware auth, credentials)

    # Quality markers
    security: Security-related tests
    performance: Performance/benchmark tests
    concurrent: Concurrency and thread safety tests
    error_handling: Error handling and recovery tests
    regression: Regression tests

    # Infrastructure markers
    mock: Tests using mocked dependencies
    live_api: Tests requiring live API access (skip in CI)
    smoke: Quick smoke tests for basic functionality

    # Skip markers
    skip: Skip this test
    skipci: Skip in CI environment
    wip: Work in progress (not ready)

# Coverage options
addopts =
    -v
    --strict-markers
    --tb=short
    --maxfail=10
    --disable-warnings

# Enable parallel execution when using pytest-xdist
# addopts = -n auto (uncomment when pytest-xdist installed)

# Coverage configuration
[coverage:run]
source = src
omit =
    */tests/*
    */venv/*
    */env/*
    */__pycache__/*
    */site-packages/*

[coverage:report]
precision = 2
skip_empty = True
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:
    @abstractmethod
    @pytest.mark.skip
